window.__require=function e(t,n,o){function i(r,c){if(!n[r]){if(!t[r]){var s=r.split("/");if(s=s[s.length-1],!t[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+r+"'")}r=s}var h=n[r]={exports:{}};t[r][0].call(h.exports,function(e){return i(t[r][1][e]||e)},h,h.exports,e,t,n,o)}return n[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<o.length;r++)i(o[r]);return i}({EnemyBullet:[function(e,t,n){"use strict";cc._RF.push(t,"af4b41LxbRCFrZ1VMOI0eDu","EnemyBullet"),cc.Class({extends:cc.Component,properties:{},start:function(){}}),cc._RF.pop()},{}],Enemy:[function(e,t,n){"use strict";cc._RF.push(t,"86076awQKxKpqWhpsg1FDmt","Enemy");var o=e("Global");cc.Class({extends:cc.Component,properties:{seed:0,EnemyBullet1Prefeb:cc.Prefab,EnemyBullet2Prefeb:cc.Prefab},start:function(){this.dtCount=0,this.schedule(function(){if(0==o.danmakuMode)for(var e=0;e<45;e++)this.createEnemyBulletFromBoss(1,this.seed+8*e,200,0);else if(1==o.danmakuMode)for(var t=0;t<45;t++)this.seed%2==0?this.createEnemyBulletFromBoss(1,2*t+180,200,0):this.createEnemyBulletFromBoss(2,2*t+270,200,0);else if(2==o.danmakuMode){for(var n=0;n<45;n++)this.createEnemyBulletFromBoss(1,this.seed+16*n,200,0);for(var i=0;i<45;i++)this.createEnemyBulletFromBoss(2,this.seed+16*i,400,0)}else if(3==o.danmakuMode)for(var a=0;a<15;a++)this.createEnemyBulletFromBoss(1,this.seed%3+60+4*a,200,2);this.seed+=1},.5)},createEnemyBulletFromBoss:function(e,t,n,o){if(this.EnemyBullet1Prefeb){if(1==e)var i=cc.instantiate(this.EnemyBullet1Prefeb);else if(2==e)i=cc.instantiate(this.EnemyBullet2Prefeb);this.node.addChild(i),i.parent=this.node.parent,i.position=this.node.position,i.x+=0;for(var a=cc.find("Canvas"),r=[],c=null,s=null,l=Math.sqrt(Math.pow(cc.winSize.width-this.node.x,2)+Math.pow(cc.winSize.height-this.node.y,2)),h=null,d=0;d<=o;){c=0==d?this.node.position:s,s=cc.v2(Math.cos(t/180*Math.PI)*l+c.x,Math.sin(t/180*Math.PI)*l+c.y),h=l/n;for(var u=cc.director.getPhysicsManager().rayCast(a.convertToWorldSpaceAR(c),a.convertToWorldSpaceAR(s),cc.RayCastType.AllClosest),y=0;y<u.length;y++)if("wall"==u[y].collider.node.group){0==u[y].normal.x&&-1==u[y].normal.y?t=360-t:0==u[y].normal.x&&1==u[y].normal.y?t=0-t:1==u[y].normal.x&&0==u[y].normal.y?t=180-t:-1==u[y].normal.x&&0==u[y].normal.y&&(t=540-t);var m=a.convertToNodeSpaceAR(u[y].point);s=cc.v2(m.x,m.y),h*=u[y].fraction}r.push(cc.moveTo(h,cc.v2(s.x,s.y))),d++}var f=cc.removeSelf();r.push(f);var p=cc.sequence(r);i.runAction(p)}},onBeginContact:function(e,t,n){var i=this;if("PlayerBullet"==n.node.name)if(n.node.destroy(),0==o.isPlayAnim)o.HP>0?(o.HP-=o.PlayerACT,o.score+=1):o.isPlayAnim=!0;else if(-1!=o.danmakuMode){var a=o.danmakuMode;o.danmakuMode=-1,o.godMode=!0,o.death+=1,this.send=0,this.cleanEnemyBullets(),a>=o.danmakuModeMAX?cc.loader.loadRes("Prefab/GameOver",function(e,t){var n=cc.instantiate(t);n.active=!0,n.parent=i.node.parent,o.lockController=!0,n.getComponent("GameOver").setTitle("\u606d\u559c\u901a\u5173")}):(this.schedule(function(){o.HP+=10},.001,59,2),this.scheduleOnce(function(){o.danmakuMode=a+1,o.godMode=!1,o.lockController=!1,o.isPlayAnim=!1},5))}},cleanEnemyBullets:function(){for(var e=cc.find("Canvas").children,t=0;t<e.length;t++)"EnemyBullet"==e[t].name&&e[t].destroy()},update:function(e){}}),cc._RF.pop()},{Global:"Global"}],GameOver:[function(e,t,n){"use strict";cc._RF.push(t,"d3b43HVMU5MvqPC82gx9wQk","GameOver"),cc.Class({extends:cc.Component,properties:{UI_Title:cc.Label},start:function(){},reStart:function(){cc.director.loadScene("Game")},setTitle:function(e){this.UI_Title.string=e}}),cc._RF.pop()},{}],Game:[function(e,t,n){"use strict";cc._RF.push(t,"5ed84xzYjpLZKMBrmL7r8SX","Game");var o=e("Global");cc.Class({extends:cc.Component,properties:{PlayerBulletPrefeb:cc.Prefab,UI_HP:cc.Label,UI_Score:cc.Label,UI_Death:cc.Label,UI_Life:cc.Label},onLoad:function(){var e=this;this.Player=null,this.nodePos=null,this.Enemy=null,this.Fire=!1,this.dtCount=0,cc.loader.loadRes("Prefab/Player",function(t,n){e.Player=cc.instantiate(n),e.node.addChild(e.Player),e.nodePos=e.Player.getPosition(),e.Player.parent.on(cc.Node.EventType.TOUCH_MOVE,e.onTouchMove,e),e.Player.parent.on(cc.Node.EventType.TOUCH_START,e.onTouchStart,e),e.Player.parent.on(cc.Node.EventType.TOUCH_END,e.onTouchEnd,e),e.Player.parent.on(cc.Node.EventType.TOUCH_CANCEL,e.onTouchCancel,e)}),cc.loader.loadRes("Prefab/Enemy",function(t,n){e.Enemy=cc.instantiate(n),e.Enemy.getComponent("Enemy").danmakuMode=0,e.Enemy.setPosition(cc.v2(0,320)),e.node.addChild(e.Enemy)}),o.init(),cc.director.getPhysicsManager().enabled=!0},start:function(){},onTouchStart:function(e){this.Fire=!0,this.nodePos=this.Player.getPosition()},onTouchMove:function(e){if(0==o.lockController){this.Fire=!0;var t=e.getTouches(),n=this.Player.parent.convertToNodeSpaceAR(t[0].getStartLocation()),i=this.Player.parent.convertToNodeSpaceAR(t[0].getLocation()),a=n.sub(i);this.Player.x=this.nodePos.x-a.x,this.Player.y=this.nodePos.y-a.y;var r=-this.Player.parent.width/2+this.Player.width/2,c=Math.abs(r),s=-this.Player.parent.height/2+this.Player.height/2,l=Math.abs(s),h=this.Player.getPosition();h.x<r&&(h.x=r),h.x>c&&(h.x=c),h.y<s&&(h.y=s),h.y>l&&(h.y=l),this.Player.setPosition(h)}},onTouchEnd:function(){0==o.lockController&&(this.Fire=!1,this.nodePos=this.Player.getPosition())},onTouchCancel:function(){0==o.lockController&&(this.Fire=!1,this.nodePos=this.Player.getPosition())},update:function(e){1==o.lockController&&(this.Fire=!1),this.Fire&&(this.dtCount+=e,this.dtCount>.05&&(this.dtCount=0,this.createPlayerBullet(10),this.createPlayerBullet(-10))),this.UI_HP.string=o.HP+" / "+o.MaxHP,this.UI_Score.string="Score: "+o.score,this.UI_Death.string="Death: "+o.death,this.UI_Life.string="Life: "+o.life},createPlayerBullet:function(e){var t=cc.instantiate(this.PlayerBulletPrefeb);this.node.addChild(t),t.parent=this.Player.parent,t.position=this.Player.position,t.x+=e;var n=cc.winSize.height-this.Player.y,o=n/1e3,i=cc.moveBy(o,cc.v2(0,n)),a=cc.removeSelf(),r=cc.sequence(i,a);t.runAction(r)}}),cc._RF.pop()},{Global:"Global"}],Global:[function(e,t,n){"use strict";cc._RF.push(t,"b7662dqrMtDSbpIpKOF+QBk","Global"),t.exports={life:0,death:0,score:0,lockController:!1,godMode:!1,MaxHP:0,HP:0,danmakuMode:0,isPlayAnim:!1,PlayerACT:2,init:function(){this.life=30,this.death=0,this.score=0,this.lockController=!1,this.godMode=!1,this.MaxHP=600,this.HP=600,this.danmakuMode=0,this.danmakuModeMAX=3,this.isPlayAnim=!1,this.PlayerACT=2}},cc._RF.pop()},{}],Main:[function(e,t,n){"use strict";cc._RF.push(t,"11421JmmbJD5YUeqZsYSZI0","Main"),cc.Class({extends:cc.Component,properties:{},start:function(){cc.director.preloadScene("Game")},startButtonOnClick:function(){cc.director.loadScene("Game")}}),cc._RF.pop()},{}],Player:[function(e,t,n){"use strict";cc._RF.push(t,"17460H8yNhLMI+h6yLkJSl/","Player");var o=e("Global");cc.Class({extends:cc.Component,properties:{UI_GameOver:cc.Prefab},start:function(){this.anim=this.getComponent(cc.Animation)},onBeginContact:function(e,t,n){"EnemyBullet"!=n.node.name&&"Enemy"!=n.node.name||o.godMode||0!=o.lockController||(o.lockController=!0,this.anim.play("Player_Death"))},playerDeath:function(){if(o.lockController=!1,o.godMode=!0,this.node.opacity=100,this.anim.play("Player"),this.node.x=0,this.node.y=-320,o.life>0)o.life-=1;else{o.danmakuMode=-1;var e=this;cc.loader.loadRes("Prefab/GameOver",function(t,n){var i=cc.instantiate(n);i.active=!0,i.parent=e.node.parent,o.lockController=!0,i.getComponent("GameOver").setTitle("\u6e38\u620f\u7ed3\u675f")})}this.scheduleOnce(function(){this.node.opacity=255,o.godMode=!1},3)}}),cc._RF.pop()},{Global:"Global"}]},{},["Enemy","EnemyBullet","Game","GameOver","Global","Main","Player"]);